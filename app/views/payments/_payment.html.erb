<li class="payment media">
  <% source = source || 'expired' %>
  <%= label_tag payment, source %>
  <div class="media-body">
    <h4 class="media-heading">
      <span class="value"><%= write_currency payment.value %></span>
      <span class="client has-popup" data-width="400px" data-placement="bottom" data-content='<%= render partial: 'clients/popup_content', locals: { client: payment.client } %>' data-title='<%= render partial: 'clients/popup_title', locals: { client: payment.client } %>'><%= payment.client.name %></span>
    </h4>
    <span class="info">
      <span class="invoice has-popup" data-width="400px" data-placement="bottom" data-content='<%= render partial: 'invoices/popup_content', locals: { invoice: payment.invoice } %>' data-title='<%= render partial: 'invoices/popup_title', locals: { invoice: payment.invoice } %>'>
        rata <%= payment.index %> di <%= payment.invoice.num_payments %> per la fattura <%= payment.invoice.number %> del <%= payment.invoice.date.strftime('%d/%b/%Y') %>
      </span>
      <span class="note"></span>
    </span>
  </div>
  <ul class="actions">
    <li>
      <%= link_to mark_payment_path(payment), method: :put, remote: true, class: 'btn btn-mini' do %>
        <% if payment.paid? %>
          <i class="icon-check" title="segna come non pagato"></i> non pagato
        <% else %>
          <i class="icon-random" title="segna come pagato"></i> pagato
        <% end %>
      <% end %>
    </li>
    <li>
      <%= link_to payment_path(payment), confirm: 'Sei sicuro di voler cancellare questa rata?', method: :delete, remote: true, title: 'elimina rata', class: 'btn btn-mini' do %>
        <i class="icon-trash"></i> elimina
      <% end %>
    </li>
  </ul>
</li>